---
title: "Exploratory Data Analysis"
format: html
---

# Exploratory Data Analysis

## Assessing Meat Import Volume Trends Over Time

```{r}
volume_meat <-
  volume |>
  filter(Category == "Meats")
```

```{r}
volume_meat <-
  volume_meat |>
  mutate(Imports = Imports * 1000) |>
  select(`U.S. food import volume, by food group`, Year, Imports)
```

```{r}
ggplot(volume_meat, aes(x = Year, y = Imports)) +
  geom_line(linewidth = 1) +
  geom_point() +
  scale_x_continuous(breaks = seq(min(volume_meat$Year), max(volume_meat$Year), by = 5)) +
  theme_minimal() +
  labs(title = "U.S. Meat Import Volume Trends (1999-2024)",
    x = "Year",
    y = "Import Volume (Metric Tons)")
```

## Assessing Dairy Import Volume Trends Over Time

```{r}
volume_dairy <-
  volume |>
  filter(Category == "Dairy")
```

```{r}
volume_dairy <-
  volume_dairy |>
  mutate(Imports = Imports * 1000) |>
  select(`U.S. food import volume, by food group`, Year, Imports)
```

```{r}
ggplot(volume_dairy, aes(x = Year, y = Imports)) +
  geom_line(linewidth = 1) +
  geom_point() +
  scale_x_continuous(breaks = seq(min(volume_dairy$Year), max(volume_dairy$Year), by = 5)) +
  theme_minimal() +
  labs(title = "U.S. Dairy Import Volume Trends (1999-2024)",
    x = "Year",
    y = "Import Volume (Metric Tons)")
```

## Assessing Rice Import Volume

```{r}
volume_rice <-
  grains |>
  filter(`U.S. imports of grains and grain products` == "Rice and products",
         Measurement == "1,000 metric tons")
```

```{r}
volume_rice <-
  volume_rice |>
  mutate(Imports = Imports * 1000) |>
  select(`U.S. imports of grains and grain products`, Year, Imports)
```

```{r}
ggplot(volume_rice, aes(x = Year, y = Imports)) +
  geom_line(linewidth = 1) +
  geom_point() +
  scale_x_continuous(breaks = seq(min(volume_rice$Year), max(volume_rice$Year), by = 5)) +
  theme_minimal() +
  labs(title = "U.S. Rice Import Volume Trends (1999-2024)",
    x = "Year",
    y = "Import Volume (Metric Tons)")
```

## Value Summary

```{r}
imports_value_sum <- value |>
  group_by(Category) |>
  summarize(
    avg_imports = mean(Imports),
    min_year = min(Year),
    max_year = max(Year))

imports_value_sum
```

## Bar Chart - Average Annual Value of U.S. Food Imports by Category, 1999–2024

```{r}
imports_value_sum |>
  ggplot(
    aes(x = reorder(Category, avg_imports), 
        y = avg_imports,
        fill = Category)) +
  geom_col() +
  coord_flip() +
  scale_fill_viridis_d(option = "turbo") +
  theme_minimal() +
  labs(
    title = "Average Annual Value of U.S. Food Imports by Category, 1999–2024",
    x = "",
    y = "Average Import Value (Million Dollars)")
```

## Line Graph - U.S. Food Imports Value Over Time (in Million Dollars), Faceted by Category, 1999-2024

```{r}
library(ggplot2)

value |>
  ggplot(
    aes(x = Year, y = Imports, color = Category)) +
  geom_line() +
  facet_wrap(~ Category, scales = "free_y") +
  theme_minimal() +
  labs(
    title = "U.S. Food Imports Value Over Time (in Million Dollars), Faceted by Category, 1999-2024",
    x = "Year",
    y = "Imports"
  )
```

## Line Graph + Points - U.S. Plant Imports Value (in Million Dollars), 1999-2024

```{r}
value |>
  filter(Category == "Plants") |>
  ggplot(
    aes(x = Year, y = Imports)) +
  geom_line() +
  geom_point() +
  labs(
    title = "U.S. Plant Imports Value (in Million Dollars), 1999-2024",
    x = "Year",
    y = "Imports"
  ) +
  theme_minimal()
```

##### Volume Summary

```{r}
volume_sum <- volume |>
  group_by(Category) |>
  summarize(
    avg_volume = mean(Imports),
    min_volume = min(Imports),
    max_volume = max(Imports))

volume_sum
```

## Line Graph - U.S. Food Imports Volume Over Time, by Category (1999-2024)

```{r}
volume |>
  filter(Measurement == "1,000 mt") |>
  ggplot(
    aes(x = Year, y = Imports, color = Category)) +
  geom_line() +
  scale_color_viridis_d(option = "turbo") +
  theme_minimal() +
  labs(
    title = "U.S. Food Imports Volume Over Time, by Category (1999-2024)",
    x = "Year",
    y = "Imports (1,000 metric tons)"
  )
```

##### Line Graph + Points - U.S. Live Meat Animal Imports in Volume (1999-2024)

```{r}
volume |>
  filter(Category == "Live meat animals") |>
  ggplot(aes(x = Year, y = Imports)) +
  geom_line() +
  geom_point() +
  labs(
    title = "U.S. Live Meat Animal Imports in Volume (1999-2024)",
    x = "Year",
    y = "Imports (1,000 head)"
  ) +
  theme_minimal()
```

##### Value & Volume

##### Joining volume and value

```{r}
sum_val_vol <- imports_value_sum |>
  inner_join(volume_sum, by = "Category")
```

##### Scatterplot - Average Value vs Volume of U.S. Food Imports

```{r}
sum_val_vol |>
  ggplot(aes(x = avg_volume, y = avg_imports, color = Category)) +
  geom_point(size = 5, alpha = 0.8) +
  scale_color_viridis_d(option = "turbo") +
  labs(
    title = "Average Value vs Volume of U.S. Food Imports",
    x = "Average Import Volume (1,000 head)",
    y = "Average Import Value (Million Dollars)",
    color = "Food Category"
  ) +
  theme_minimal()
```
